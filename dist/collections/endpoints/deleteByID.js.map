{"version":3,"sources":["../../../src/collections/endpoints/deleteByID.ts"],"sourcesContent":["import { status as httpStatus } from 'http-status'\n\nimport type { PayloadHandler } from '../../config/types.js'\n\nimport { getRequestCollectionWithID } from '../../utilities/getRequestEntity.js'\nimport { headersWithCors } from '../../utilities/headersWithCors.js'\nimport { isNumber } from '../../utilities/isNumber.js'\nimport { sanitizePopulateParam } from '../../utilities/sanitizePopulateParam.js'\nimport { sanitizeSelectParam } from '../../utilities/sanitizeSelectParam.js'\nimport { deleteByIDOperation } from '../operations/deleteByID.js'\n\nexport const deleteByIDHandler: PayloadHandler = async (req) => {\n  const { id, collection } = getRequestCollectionWithID(req)\n  const { searchParams } = req\n  const depth = searchParams.get('depth')\n  const overrideLock = searchParams.get('overrideLock')\n\n  const doc = await deleteByIDOperation({\n    id,\n    collection,\n    depth: isNumber(depth) ? depth : undefined,\n    overrideLock: Boolean(overrideLock === 'true'),\n    populate: sanitizePopulateParam(req.query.populate),\n    req,\n    select: sanitizeSelectParam(req.query.select),\n  })\n\n  const headers = headersWithCors({\n    headers: new Headers(),\n    req,\n  })\n\n  if (!doc) {\n    return Response.json(\n      {\n        message: req.t('general:notFound'),\n      },\n      {\n        headers,\n        status: httpStatus.NOT_FOUND,\n      },\n    )\n  }\n\n  return Response.json(\n    {\n      doc,\n      message: req.t('general:deletedSuccessfully'),\n    },\n    {\n      headers,\n      status: httpStatus.OK,\n    },\n  )\n}\n"],"names":["status","httpStatus","getRequestCollectionWithID","headersWithCors","isNumber","sanitizePopulateParam","sanitizeSelectParam","deleteByIDOperation","deleteByIDHandler","req","id","collection","searchParams","depth","get","overrideLock","doc","undefined","Boolean","populate","query","select","headers","Headers","Response","json","message","t","NOT_FOUND","OK"],"mappings":"AAAA,SAASA,UAAUC,UAAU,QAAQ,cAAa;AAIlD,SAASC,0BAA0B,QAAQ,sCAAqC;AAChF,SAASC,eAAe,QAAQ,qCAAoC;AACpE,SAASC,QAAQ,QAAQ,8BAA6B;AACtD,SAASC,qBAAqB,QAAQ,2CAA0C;AAChF,SAASC,mBAAmB,QAAQ,yCAAwC;AAC5E,SAASC,mBAAmB,QAAQ,8BAA6B;AAEjE,OAAO,MAAMC,oBAAoC,OAAOC;IACtD,MAAM,EAAEC,EAAE,EAAEC,UAAU,EAAE,GAAGT,2BAA2BO;IACtD,MAAM,EAAEG,YAAY,EAAE,GAAGH;IACzB,MAAMI,QAAQD,aAAaE,GAAG,CAAC;IAC/B,MAAMC,eAAeH,aAAaE,GAAG,CAAC;IAEtC,MAAME,MAAM,MAAMT,oBAAoB;QACpCG;QACAC;QACAE,OAAOT,SAASS,SAASA,QAAQI;QACjCF,cAAcG,QAAQH,iBAAiB;QACvCI,UAAUd,sBAAsBI,IAAIW,KAAK,CAACD,QAAQ;QAClDV;QACAY,QAAQf,oBAAoBG,IAAIW,KAAK,CAACC,MAAM;IAC9C;IAEA,MAAMC,UAAUnB,gBAAgB;QAC9BmB,SAAS,IAAIC;QACbd;IACF;IAEA,IAAI,CAACO,KAAK;QACR,OAAOQ,SAASC,IAAI,CAClB;YACEC,SAASjB,IAAIkB,CAAC,CAAC;QACjB,GACA;YACEL;YACAtB,QAAQC,WAAW2B,SAAS;QAC9B;IAEJ;IAEA,OAAOJ,SAASC,IAAI,CAClB;QACET;QACAU,SAASjB,IAAIkB,CAAC,CAAC;IACjB,GACA;QACEL;QACAtB,QAAQC,WAAW4B,EAAE;IACvB;AAEJ,EAAC"}