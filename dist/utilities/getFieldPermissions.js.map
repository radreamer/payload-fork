{"version":3,"sources":["../../src/utilities/getFieldPermissions.ts"],"sourcesContent":["// @ts-strict-ignore\nimport type { SanitizedFieldPermissions } from '../auth/types.js'\nimport type { ClientField, Field } from '../fields/config/types.js'\nimport type { Operation } from '../types/index.js'\n\n/**\n * Gets read and operation-level permissions for a given field based on cascading field permissions.\n * @returns An object with the following properties:\n * - `operation`: Whether the user has permission to perform the operation on the field (`create` or `update`).\n * - `permissions`: The field-level permissions.\n * - `read`: Whether the user has permission to read the field.\n */\nexport const getFieldPermissions = ({\n  field,\n  operation,\n  parentName,\n  permissions,\n}: {\n  readonly field: ClientField | Field\n  readonly operation: Operation\n  readonly parentName: string\n  readonly permissions:\n    | {\n        [fieldName: string]: SanitizedFieldPermissions\n      }\n    | SanitizedFieldPermissions\n}): {\n  operation: boolean\n  permissions: SanitizedFieldPermissions\n  read: boolean\n} => ({\n  operation:\n    permissions === true ||\n    permissions?.[operation] === true ||\n    permissions?.[parentName] === true ||\n    ('name' in field &&\n      typeof permissions === 'object' &&\n      permissions?.[field.name] &&\n      (permissions[field.name] === true ||\n        (operation in permissions[field.name] && permissions[field.name][operation]))),\n  permissions:\n    permissions === undefined || permissions === null || permissions === true\n      ? true\n      : 'name' in field\n        ? permissions?.[field.name]\n        : permissions,\n  read:\n    permissions === true ||\n    permissions?.read === true ||\n    permissions?.[parentName] === true ||\n    ('name' in field &&\n      typeof permissions === 'object' &&\n      permissions?.[field.name] &&\n      (permissions[field.name] === true ||\n        ('read' in permissions[field.name] && permissions[field.name].read))),\n})\n"],"names":["getFieldPermissions","field","operation","parentName","permissions","name","undefined","read"],"mappings":"AAAA,oBAAoB;AAKpB;;;;;;CAMC,GACD,OAAO,MAAMA,sBAAsB,CAAC,EAClCC,KAAK,EACLC,SAAS,EACTC,UAAU,EACVC,WAAW,EAUZ,GAIK,CAAA;QACJF,WACEE,gBAAgB,QAChBA,aAAa,CAACF,UAAU,KAAK,QAC7BE,aAAa,CAACD,WAAW,KAAK,QAC7B,UAAUF,SACT,OAAOG,gBAAgB,YACvBA,aAAa,CAACH,MAAMI,IAAI,CAAC,IACxBD,CAAAA,WAAW,CAACH,MAAMI,IAAI,CAAC,KAAK,QAC1BH,aAAaE,WAAW,CAACH,MAAMI,IAAI,CAAC,IAAID,WAAW,CAACH,MAAMI,IAAI,CAAC,CAACH,UAAU;QACjFE,aACEA,gBAAgBE,aAAaF,gBAAgB,QAAQA,gBAAgB,OACjE,OACA,UAAUH,QACRG,aAAa,CAACH,MAAMI,IAAI,CAAC,GACzBD;QACRG,MACEH,gBAAgB,QAChBA,aAAaG,SAAS,QACtBH,aAAa,CAACD,WAAW,KAAK,QAC7B,UAAUF,SACT,OAAOG,gBAAgB,YACvBA,aAAa,CAACH,MAAMI,IAAI,CAAC,IACxBD,CAAAA,WAAW,CAACH,MAAMI,IAAI,CAAC,KAAK,QAC1B,UAAUD,WAAW,CAACH,MAAMI,IAAI,CAAC,IAAID,WAAW,CAACH,MAAMI,IAAI,CAAC,CAACE,IAAI;IAC1E,CAAA,EAAE"}